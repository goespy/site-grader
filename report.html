<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Website Grade Report | SiteGrade</title>
  <meta property="og:title" content="Website Grade Report | SiteGrade">
  <meta property="og:description" content="See how this site scores on mobile, speed, SEO, and more.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&family=Poppins:wght@500;600;700;800;900&display=swap" rel="stylesheet">
<style>
/* ============================================================
   CSS VARIABLES & RESET
   ============================================================ */
:root {
  --color-bg: #F8FAFC;
  --color-bg-white: #ffffff;
  --color-primary: #0369A1;
  --color-primary-hover: #0284C7;
  --color-primary-light: rgba(3, 105, 161, 0.08);
  --color-text: #0F172A;
  --color-text-secondary: #475569;
  --color-text-muted: #94A3B8;
  --color-card: rgba(255, 255, 255, 0.8);
  --color-border: #E2E8F0;
  --color-input-bg: #ffffff;
  --color-input-border: #CBD5E1;
  --color-success: #16A34A;
  --color-error: #DC2626;
  --font-heading: 'Poppins', sans-serif;
  --font-body: 'Open Sans', sans-serif;
  --ease-smooth: cubic-bezier(0.16, 1, 0.3, 1);
  --nav-height: 72px;
  --shadow-sm: 0 1px 2px rgba(15, 23, 42, 0.06);
  --shadow-md: 0 4px 16px rgba(15, 23, 42, 0.08);
  --shadow-lg: 0 12px 40px rgba(15, 23, 42, 0.1);
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body {
  font-family: var(--font-body);
  color: var(--color-text);
  background: var(--color-bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  min-height: 100vh;
}
a { text-decoration: none; color: inherit; }

/* ============================================================
   NAVIGATION
   ============================================================ */
.nav {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--nav-height);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 48px;
  z-index: 1000;
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border-bottom: 1px solid var(--color-border);
}

.nav__brand {
  display: flex;
  align-items: center;
}

.nav__brand-name {
  font-family: var(--font-heading);
  font-size: 22px;
  font-weight: 800;
  letter-spacing: -0.02em;
  color: var(--color-text);
}

.nav__brand-name span {
  color: var(--color-primary);
}

.nav__tag {
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--color-text-muted);
  margin-left: 16px;
  padding-left: 16px;
  border-left: 1px solid var(--color-border);
}

.nav__scan-link {
  font-family: var(--font-heading);
  font-size: 14px;
  font-weight: 600;
  color: var(--color-primary);
  padding: 10px 20px;
  border: 1px solid rgba(3, 105, 161, 0.2);
  border-radius: 8px;
  transition: background 0.2s ease, color 0.2s ease;
  cursor: pointer;
}

.nav__scan-link:hover {
  background: var(--color-primary);
  color: #ffffff;
}

/* ============================================================
   LOADING STATE
   ============================================================ */
.loading-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  gap: 32px;
  padding-top: var(--nav-height);
}

.loading-grade-placeholder {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  background: var(--color-primary-light);
  border: 3px solid var(--color-border);
  animation: pulse-grade 1.8s ease-in-out infinite;
}

@keyframes pulse-grade {
  0%, 100% { opacity: 0.4; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
}

.loading-text {
  font-family: var(--font-heading);
  font-size: 18px;
  font-weight: 600;
  color: var(--color-text-muted);
  letter-spacing: 0.02em;
}

.loading-spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--color-border);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* ============================================================
   ERROR STATE
   ============================================================ */
.error-state {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  gap: 24px;
  text-align: center;
  padding: calc(var(--nav-height) + 24px) 24px 24px;
}

.error-icon {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: rgba(220, 38, 38, 0.08);
  border: 2px solid rgba(220, 38, 38, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 36px;
  font-weight: 800;
  color: var(--color-error);
}

.error-title {
  font-family: var(--font-heading);
  font-size: 24px;
  font-weight: 700;
  color: var(--color-text);
}

.error-message {
  font-size: 16px;
  color: var(--color-text-muted);
  max-width: 400px;
  line-height: 1.6;
}

.error-link {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 14px 32px;
  background: var(--color-primary);
  color: #ffffff;
  font-family: var(--font-heading);
  font-size: 15px;
  font-weight: 700;
  letter-spacing: 0.02em;
  border-radius: 10px;
  transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
}

.error-link:hover {
  transform: translateY(-2px);
  background: var(--color-primary-hover);
  box-shadow: 0 8px 24px rgba(3, 105, 161, 0.25);
}

/* ============================================================
   REPORT CONTAINER
   ============================================================ */
.report {
  display: none;
  max-width: 960px;
  margin: 0 auto;
  padding: calc(var(--nav-height) + 40px) 24px 80px;
}

/* ============================================================
   REPORT HEADER
   ============================================================ */
.report-header {
  text-align: center;
  padding: 40px 0 48px;
}

.grade-container {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 180px;
  height: 180px;
  margin-bottom: 24px;
}

.grade-glow {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  filter: blur(40px);
  opacity: 0.2;
}

.grade-ring {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 3px solid;
  opacity: 0.25;
}

.grade-letter {
  position: relative;
  font-family: var(--font-heading);
  font-size: 120px;
  font-weight: 900;
  line-height: 1;
  z-index: 1;
}

.grade-score {
  font-family: var(--font-heading);
  font-size: 28px;
  font-weight: 700;
  color: var(--color-text-muted);
  margin-bottom: 20px;
}

.grade-score span {
  color: var(--color-text);
  font-size: 32px;
}

.report-meta {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  gap: 8px 20px;
  margin-bottom: 24px;
  font-size: 14px;
  color: var(--color-text-muted);
}

.report-meta-sep {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--color-border);
}

.report-url {
  color: var(--color-primary);
  font-weight: 600;
  word-break: break-all;
}

.report-verdict {
  font-family: var(--font-heading);
  font-size: 20px;
  font-weight: 600;
  color: var(--color-text);
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.5;
}

/* ============================================================
   MONEY LINE (WASTED SPEND)
   ============================================================ */
.money-line {
  display: none;
  margin: 0 0 48px;
  padding: 24px 28px;
  background: rgba(234, 88, 12, 0.05);
  border: 1px solid rgba(234, 88, 12, 0.2);
  border-left: 4px solid #EA580C;
  border-radius: 12px;
}

.money-line-label {
  display: block;
  font-family: var(--font-heading);
  font-size: 11px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: #EA580C;
  margin-bottom: 10px;
}

.money-line-text {
  font-size: 17px;
  font-weight: 600;
  color: var(--color-text);
  line-height: 1.6;
}

/* ============================================================
   CATEGORY CARDS
   ============================================================ */
.categories-heading {
  font-family: var(--font-heading);
  font-size: 11px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--color-primary);
  margin-bottom: 24px;
}

.categories-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 56px;
}

.category-card {
  background: var(--color-card);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--color-border);
  border-radius: 16px;
  padding: 24px;
  box-shadow: var(--shadow-sm);
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.category-card:hover {
  border-color: var(--color-input-border);
  box-shadow: var(--shadow-md);
}

.category-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}

.category-name {
  font-family: var(--font-heading);
  font-size: 16px;
  font-weight: 700;
  color: var(--color-text);
}

.category-grade-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 44px;
  height: 30px;
  padding: 0 12px;
  border-radius: 100px;
  font-family: var(--font-heading);
  font-size: 14px;
  font-weight: 800;
  letter-spacing: 0.05em;
  color: #ffffff;
}

.category-score-bar-track {
  width: 100%;
  height: 4px;
  background: var(--color-border);
  border-radius: 2px;
  margin-bottom: 16px;
  overflow: hidden;
}

.category-score-bar-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 1s var(--ease-smooth);
}

.category-summary {
  font-size: 14px;
  color: var(--color-text-muted);
  line-height: 1.5;
  margin-bottom: 12px;
}

.category-toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: none;
  border: none;
  color: var(--color-primary);
  font-family: var(--font-body);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  padding: 4px 0;
  transition: color 0.2s;
}

.category-toggle:hover {
  color: var(--color-primary-hover);
}

.category-toggle-arrow {
  display: inline-block;
  transition: transform 0.3s var(--ease-smooth);
  font-size: 10px;
}

.category-toggle.open .category-toggle-arrow {
  transform: rotate(180deg);
}

.category-findings {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s var(--ease-smooth);
}

.category-findings.open {
  max-height: 1200px;
}

.findings-list {
  padding-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.finding-item {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  font-size: 13px;
  line-height: 1.5;
}

.finding-icon {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  margin-top: 1px;
}

.finding-icon.pass {
  background: rgba(22, 163, 74, 0.1);
  color: var(--color-success);
}

.finding-icon.fail {
  background: rgba(220, 38, 38, 0.08);
  color: var(--color-error);
}

.finding-label {
  font-weight: 600;
  color: var(--color-text);
}

.finding-detail {
  color: var(--color-text-muted);
}

/* ============================================================
   PRIORITY FIXES
   ============================================================ */
.priority-fixes {
  margin-bottom: 56px;
}

.priority-heading {
  font-family: var(--font-heading);
  font-size: 11px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--color-primary);
  margin-bottom: 24px;
}

.priority-title {
  font-family: var(--font-heading);
  font-size: 28px;
  font-weight: 800;
  color: var(--color-text);
  margin-bottom: 28px;
}

.fix-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.fix-item {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 20px 24px;
  background: var(--color-card);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  box-shadow: var(--shadow-sm);
}

.fix-number {
  flex-shrink: 0;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--color-primary-light);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-heading);
  font-size: 14px;
  font-weight: 800;
  color: var(--color-primary);
}

.fix-content {
  flex: 1;
  min-width: 0;
}

.fix-top-row {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 6px;
}

.fix-label {
  font-family: var(--font-heading);
  font-size: 15px;
  font-weight: 700;
  color: var(--color-text);
}

.effort-badge {
  display: inline-flex;
  align-items: center;
  padding: 3px 10px;
  border-radius: 100px;
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.effort-badge.quick {
  background: rgba(22, 163, 74, 0.1);
  color: var(--color-success);
}

.effort-badge.medium {
  background: rgba(234, 179, 8, 0.12);
  color: #CA8A04;
}

.effort-badge.involved {
  background: rgba(234, 88, 12, 0.1);
  color: #EA580C;
}

.fix-detail {
  font-size: 14px;
  color: var(--color-text-muted);
  line-height: 1.5;
}

/* ============================================================
   MID-PAGE CTA
   ============================================================ */
.mid-cta {
  margin-bottom: 48px;
  padding: 28px 32px;
  background: var(--color-primary-light);
  border: 1px solid rgba(3, 105, 161, 0.15);
  border-left: 4px solid var(--color-primary);
  border-radius: 12px;
  text-align: left;
}

.mid-cta__label {
  display: block;
  font-family: var(--font-heading);
  font-size: 11px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--color-primary);
  margin-bottom: 10px;
}

.mid-cta__text {
  font-size: 18px;
  font-weight: 600;
  color: var(--color-text);
  line-height: 1.5;
  margin-bottom: 20px;
}

.mid-cta__btn {
  display: inline-flex;
  align-items: center;
  padding: 14px 32px;
  background: var(--color-primary);
  color: #ffffff;
  font-family: var(--font-heading);
  font-size: 15px;
  font-weight: 700;
  letter-spacing: 0.02em;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
}

.mid-cta__btn:hover {
  transform: translateY(-2px);
  background: var(--color-primary-hover);
  box-shadow: 0 8px 24px rgba(3, 105, 161, 0.25);
}

/* ============================================================
   BOTTOM CTAS
   ============================================================ */
.bottom-ctas {
  display: flex;
  gap: 16px;
  margin-bottom: 64px;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 18px 36px;
  font-family: var(--font-heading);
  font-size: 15px;
  font-weight: 700;
  letter-spacing: 0.02em;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  flex: 1;
  min-width: 0;
}

.btn:hover {
  transform: translateY(-2px);
}

.btn-share {
  background: var(--color-bg-white);
  color: var(--color-text);
  border: 1px solid var(--color-border);
}

.btn-share:hover {
  background: var(--color-bg-white);
  box-shadow: var(--shadow-md);
}

.btn-consult {
  background: var(--color-primary);
  color: #ffffff;
}

.btn-consult:hover {
  background: var(--color-primary-hover);
  box-shadow: 0 8px 24px rgba(3, 105, 161, 0.25);
}

/* ============================================================
   LEAD CAPTURE FORM
   ============================================================ */
.lead-section {
  padding: 56px 0 0;
}

.lead-card {
  background: var(--color-card);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--color-border);
  border-radius: 20px;
  padding: 48px 40px;
  text-align: center;
  max-width: 560px;
  margin: 0 auto;
  box-shadow: var(--shadow-lg);
}

.lead-heading {
  font-family: var(--font-heading);
  font-size: 32px;
  font-weight: 800;
  color: var(--color-text);
  margin-bottom: 8px;
}

.lead-subheading {
  font-size: 16px;
  color: var(--color-text-muted);
  margin-bottom: 32px;
  line-height: 1.6;
}

.lead-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.lead-form input {
  width: 100%;
  padding: 16px 20px;
  background: var(--color-input-bg);
  border: 1px solid var(--color-input-border);
  border-radius: 10px;
  font-family: var(--font-body);
  font-size: 15px;
  font-weight: 500;
  color: var(--color-text);
  outline: none;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.lead-form input::placeholder {
  color: var(--color-text-muted);
}

.lead-form input:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px rgba(3, 105, 161, 0.1);
}

.btn-submit {
  width: 100%;
  padding: 18px;
  background: var(--color-primary);
  color: #ffffff;
  font-family: var(--font-heading);
  font-size: 16px;
  font-weight: 700;
  letter-spacing: 0.02em;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
}

.btn-submit:hover {
  background: var(--color-primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(3, 105, 161, 0.25);
}

.btn-submit:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.lead-success, .lead-error {
  display: none;
  padding: 16px;
  border-radius: 10px;
  font-size: 15px;
  font-weight: 600;
  text-align: center;
}

.lead-success {
  background: rgba(22, 163, 74, 0.08);
  border: 1px solid rgba(22, 163, 74, 0.2);
  color: var(--color-success);
}

.lead-error {
  background: rgba(220, 38, 38, 0.06);
  border: 1px solid rgba(220, 38, 38, 0.2);
  color: var(--color-error);
}

.lead-trust {
  margin-top: 16px;
  font-size: 12px;
  font-weight: 400;
  color: var(--color-text-muted);
  text-align: center;
  letter-spacing: 0.01em;
}

/* ============================================================
   FOOTER
   ============================================================ */
.report-footer {
  text-align: center;
  padding: 56px 0 32px;
  font-size: 13px;
  color: var(--color-text-muted);
  border-top: 1px solid var(--color-border);
  margin-top: 20px;
}

.report-footer a {
  color: var(--color-primary);
  font-weight: 600;
  transition: color 0.2s;
}

.report-footer a:hover {
  color: var(--color-primary-hover);
}

/* ============================================================
   RESPONSIVE
   ============================================================ */
@media (max-width: 768px) {
  .nav {
    padding: 0 20px;
  }

  .nav__tag {
    display: none;
  }

  .report {
    padding: calc(var(--nav-height) + 24px) 16px 60px;
  }

  .report-header {
    padding: 24px 0 36px;
  }

  .grade-container {
    width: 150px;
    height: 150px;
  }

  .grade-letter {
    font-size: 96px;
  }

  .grade-score {
    font-size: 22px;
  }

  .grade-score span {
    font-size: 26px;
  }

  .report-verdict {
    font-size: 17px;
  }

  .categories-grid {
    grid-template-columns: 1fr;
  }

  .bottom-ctas {
    flex-direction: column;
  }

  .lead-card {
    padding: 32px 24px;
  }

  .lead-heading {
    font-size: 26px;
  }

  .priority-title {
    font-size: 24px;
  }

  .fix-item {
    padding: 16px 18px;
  }
}

@media (max-width: 480px) {
  .report-meta {
    flex-direction: column;
    gap: 6px;
  }

  .report-meta-sep {
    display: none;
  }
}
</style>
</head>
<body>

<!-- Navigation -->
<nav class="nav">
  <a href="/" class="nav__brand">
    <div class="nav__brand-name">Site<span>Grade</span></div>
    <div class="nav__tag">Free Website Audit</div>
  </a>
  <a href="/" class="nav__scan-link">Scan Another Site</a>
</nav>

<!-- Loading State -->
<div id="loading" class="loading-state">
  <div class="loading-grade-placeholder"></div>
  <div class="loading-spinner"></div>
  <div class="loading-text">Loading your report...</div>
</div>

<!-- Error State -->
<div id="error" class="error-state">
  <div class="error-icon">!</div>
  <h1 class="error-title">Report Not Found</h1>
  <p class="error-message">This report may have expired or the link is invalid. Reports are available for 30 days after scanning.</p>
  <a href="/" class="error-link">Scan Another Site</a>
</div>

<!-- Report -->
<div id="report" class="report">

  <!-- Header -->
  <div class="report-header">
    <div class="grade-container">
      <div class="grade-glow" id="gradeGlow"></div>
      <div class="grade-ring" id="gradeRing"></div>
      <div class="grade-letter" id="gradeLetter"></div>
    </div>
    <div class="grade-score"><span id="gradeScore"></span>/100</div>
    <div class="report-meta">
      <span class="report-url" id="reportUrl"></span>
      <span class="report-meta-sep"></span>
      <span id="reportBizType"></span>
      <span class="report-meta-sep"></span>
      <span id="reportDate"></span>
    </div>
    <p class="report-verdict" id="reportVerdict"></p>
  </div>

  <!-- Money Line -->
  <div class="money-line" id="moneyLine">
    <span class="money-line-label">Estimated Wasted Ad Spend</span>
    <p class="money-line-text" id="moneyLineText"></p>
  </div>

  <!-- Category Cards -->
  <div class="categories-heading">Category Breakdown</div>
  <div class="categories-grid" id="categoriesGrid"></div>

  <!-- Priority Fixes -->
  <div class="priority-fixes" id="priorityFixes">
    <div class="priority-heading">Recommendations</div>
    <h2 class="priority-title">Fix These First</h2>
    <div class="fix-list" id="fixList"></div>
  </div>

  <!-- Mid-page CTA (injected by JS after priority fixes) -->
  <div class="mid-cta" id="midCta" style="display:none;">
    <span class="mid-cta__label">Next Step</span>
    <p class="mid-cta__text" id="midCtaText">We build sites that score A+. Want us to fix yours?</p>
    <button class="mid-cta__btn" id="midCtaBtn">Book a Free 15-Min Call</button>
  </div>

  <!-- Bottom CTAs -->
  <div class="bottom-ctas">
    <button class="btn btn-share" id="shareBtn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>
      Share This Report
    </button>
    <button class="btn btn-consult" id="consultBtn">
      Get Help Fixing This
    </button>
  </div>

  <!-- Lead Capture Form -->
  <div class="lead-section" id="leadSection">
    <div class="lead-card">
      <h2 class="lead-heading" id="leadHeading">Want this fixed?</h2>
      <p class="lead-subheading" id="leadSubheading">Book a free 15-minute call. We'll screen-share your report and show you exactly what to fix first &mdash; no pressure, no contracts.</p>
      <form class="lead-form" id="leadForm">
        <input type="text" name="name" placeholder="First name" required autocomplete="given-name">
        <input type="email" name="email" placeholder="Email address" required autocomplete="email">
        <input type="tel" name="phone" placeholder="Best phone number (optional)" autocomplete="tel">
        <button type="submit" class="btn-submit" id="leadSubmitBtn">Book My Free Call</button>
      </form>
      <p class="lead-trust" id="leadTrust">We'll never spam you or share your info. Just one helpful call.</p>
      <div class="lead-success" id="leadSuccess">You're in! Check your inbox &mdash; we'll send a calendar link within a few hours.</div>
      <div class="lead-error" id="leadError">Something went wrong. Please try again.</div>
    </div>
  </div>

  <!-- Footer -->
  <div class="report-footer">
    Powered by <a href="/">SiteGrade</a>
  </div>

</div>

<script>
(function () {
  'use strict';

  var API_URL = 'https://site-grader-api.mikegoewey.workers.dev';

  // DOM references
  var loadingEl = document.getElementById('loading');
  var errorEl = document.getElementById('error');
  var reportEl = document.getElementById('report');

  // Parse report ID from URL
  var params = new URLSearchParams(window.location.search);
  var reportId = params.get('id');

  if (!reportId) {
    showError();
  } else {
    fetch(API_URL + '/api/report/' + encodeURIComponent(reportId))
      .then(function (r) {
        if (!r.ok) throw new Error('Not found');
        return r.json();
      })
      .then(renderReport)
      .catch(showError);
  }

  function showError() {
    loadingEl.style.display = 'none';
    errorEl.style.display = 'flex';
    reportEl.style.display = 'none';
  }

  function escapeHtml(str) {
    var div = document.createElement('div');
    div.appendChild(document.createTextNode(str));
    return div.innerHTML;
  }

  function formatDate(iso) {
    try {
      var d = new Date(iso);
      return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    } catch (e) {
      return iso;
    }
  }

  function gradeColorFromGrade(grade) {
    var letter = grade.charAt(0);
    switch (letter) {
      case 'A': return '#16A34A';
      case 'B': return '#0369A1';
      case 'C': return '#CA8A04';
      case 'D': return '#EA580C';
      default:  return '#DC2626';
    }
  }

  function renderReport(report) {
    loadingEl.style.display = 'none';
    errorEl.style.display = 'none';
    reportEl.style.display = 'block';

    var overallColor = gradeColorFromGrade(report.overallGrade);

    // --- Header ---
    var gradeGlow = document.getElementById('gradeGlow');
    var gradeRing = document.getElementById('gradeRing');
    var gradeLetter = document.getElementById('gradeLetter');
    var gradeScore = document.getElementById('gradeScore');

    gradeGlow.style.background = 'radial-gradient(circle, ' + overallColor + ' 0%, transparent 70%)';
    gradeRing.style.borderColor = overallColor;
    gradeLetter.textContent = report.overallGrade;
    gradeLetter.style.color = overallColor;
    gradeScore.textContent = report.overallScore;

    document.getElementById('reportUrl').textContent = report.url || report.finalUrl || '';
    document.getElementById('reportBizType').textContent = report.businessType || '';
    document.getElementById('reportDate').textContent = report.scannedAt ? formatDate(report.scannedAt) : '';
    document.getElementById('reportVerdict').textContent = report.verdict || '';

    // --- Money Line ---
    if (report.wastedSpend && report.wastedSpendVerdict) {
      var moneyLine = document.getElementById('moneyLine');
      moneyLine.style.display = 'block';
      document.getElementById('moneyLineText').textContent = report.wastedSpendVerdict;
    }

    // --- Categories ---
    var grid = document.getElementById('categoriesGrid');
    grid.innerHTML = '';

    if (report.categories && report.categories.length > 0) {
      report.categories.forEach(function (cat, catIndex) {
        var color = cat.gradeColor || gradeColorFromGrade(cat.grade);

        // Sort findings: fails first, then passes
        var sortedFindings = (cat.findings || []).slice().sort(function (a, b) {
          if (a.pass === b.pass) return 0;
          return a.pass ? 1 : -1;
        });

        // First failing finding as summary; if all pass, use first finding
        var summaryFinding = sortedFindings.find(function (f) { return !f.pass; }) || sortedFindings[0];
        var summaryText = summaryFinding ? summaryFinding.detail : '';

        // Build findings HTML
        var findingsHtml = '';
        sortedFindings.forEach(function (f) {
          var iconClass = f.pass ? 'pass' : 'fail';
          var iconChar = f.pass ? '\u2713' : '\u2717';
          findingsHtml += '<div class="finding-item">' +
            '<div class="finding-icon ' + iconClass + '">' + iconChar + '</div>' +
            '<div>' +
              '<div class="finding-label">' + escapeHtml(f.label) + '</div>' +
              '<div class="finding-detail">' + escapeHtml(f.detail) + '</div>' +
            '</div>' +
          '</div>';
        });

        var card = document.createElement('div');
        card.className = 'category-card';
        card.innerHTML =
          '<div class="category-header">' +
            '<div class="category-name">' + escapeHtml(cat.name) + '</div>' +
            '<div class="category-grade-badge" style="background:' + color + '">' + escapeHtml(cat.grade) + '</div>' +
          '</div>' +
          '<div class="category-score-bar-track">' +
            '<div class="category-score-bar-fill" style="width:0%;background:' + color + '" data-width="' + cat.score + '"></div>' +
          '</div>' +
          '<div class="category-summary">' + escapeHtml(summaryText) + '</div>' +
          '<button class="category-toggle" data-cat="' + catIndex + '">' +
            'Show details <span class="category-toggle-arrow">\u25BC</span>' +
          '</button>' +
          '<div class="category-findings" id="findings-' + catIndex + '">' +
            '<div class="findings-list">' + findingsHtml + '</div>' +
          '</div>';

        grid.appendChild(card);
      });

      // Animate score bars
      requestAnimationFrame(function () {
        var fills = grid.querySelectorAll('.category-score-bar-fill');
        fills.forEach(function (fill) {
          fill.style.width = fill.getAttribute('data-width') + '%';
        });
      });

      // Wire up toggles
      grid.addEventListener('click', function (e) {
        var toggle = e.target.closest('.category-toggle');
        if (!toggle) return;
        var catIdx = toggle.getAttribute('data-cat');
        var findings = document.getElementById('findings-' + catIdx);
        if (findings) {
          var isOpen = findings.classList.contains('open');
          findings.classList.toggle('open');
          toggle.classList.toggle('open');
          toggle.childNodes[0].textContent = isOpen ? 'Show details ' : 'Hide details ';
        }
      });
    }

    // --- Priority Fixes ---
    var fixesSection = document.getElementById('priorityFixes');
    var fixList = document.getElementById('fixList');
    fixList.innerHTML = '';

    if (report.priorityFixes && report.priorityFixes.length > 0) {
      fixesSection.style.display = 'block';
      report.priorityFixes.forEach(function (fix, idx) {
        var effortLabel = fix.effort || 'medium';
        var effortClass = effortLabel;

        var item = document.createElement('div');
        item.className = 'fix-item';
        item.innerHTML =
          '<div class="fix-number">' + (idx + 1) + '</div>' +
          '<div class="fix-content">' +
            '<div class="fix-top-row">' +
              '<span class="fix-label">' + escapeHtml(fix.label) + '</span>' +
              '<span class="effort-badge ' + effortClass + '">' + effortLabel + '</span>' +
            '</div>' +
            '<div class="fix-detail">' + escapeHtml(fix.detail) + '</div>' +
          '</div>';
        fixList.appendChild(item);
      });
    } else {
      fixesSection.style.display = 'none';
    }

    // --- Dynamic Lead Heading ---
    var grade = report.overallGrade || '';
    document.getElementById('leadHeading').textContent = 'Your site scored a ' + grade + '. Let\u2019s fix that.';

    // --- Mid-page CTA ---
    var midCta = document.getElementById('midCta');
    if (report.priorityFixes && report.priorityFixes.length > 0) {
      midCta.style.display = 'block';
      var midText = 'We build sites that convert. Want us to bring yours up to an A+?';
      if (report.wastedSpend && report.wastedSpendVerdict) {
        midText = report.wastedSpendVerdict + ' We can fix that.';
      }
      document.getElementById('midCtaText').textContent = midText;
    }

    // Wire mid-CTA button to scroll to lead form
    document.getElementById('midCtaBtn').addEventListener('click', function () {
      document.getElementById('leadSection').scrollIntoView({ behavior: 'smooth' });
    });

    // --- Share Button ---
    var shareBtn = document.getElementById('shareBtn');
    shareBtn.addEventListener('click', function () {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(window.location.href).then(function () {
          shareBtn.innerHTML =
            '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>' +
            'Link Copied!';
          setTimeout(function () {
            shareBtn.innerHTML =
              '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>' +
              'Share This Report';
          }, 2000);
        });
      }
    });

    // --- Consult Button ---
    var consultBtn = document.getElementById('consultBtn');
    consultBtn.addEventListener('click', function () {
      document.getElementById('leadSection').scrollIntoView({ behavior: 'smooth' });
    });

    // --- Lead Form ---
    var leadForm = document.getElementById('leadForm');
    var leadSubmitBtn = document.getElementById('leadSubmitBtn');
    var leadSuccess = document.getElementById('leadSuccess');
    var leadError = document.getElementById('leadError');

    leadForm.addEventListener('submit', function (e) {
      e.preventDefault();
      leadSuccess.style.display = 'none';
      leadError.style.display = 'none';
      leadSubmitBtn.disabled = true;
      leadSubmitBtn.textContent = 'Sending...';

      var formData = new FormData(leadForm);
      var payload = {
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone') || '',
        reportId: reportId,
      };

      fetch(API_URL + '/api/lead', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      })
        .then(function (r) {
          if (!r.ok) throw new Error('Failed');
          return r.json();
        })
        .then(function () {
          leadForm.style.display = 'none';
          document.getElementById('leadTrust').style.display = 'none';
          leadSuccess.style.display = 'block';
        })
        .catch(function () {
          leadError.style.display = 'block';
          leadSubmitBtn.disabled = false;
          leadSubmitBtn.textContent = 'Book My Free Call';
        });
    });
  }
})();
</script>
</body>
</html>
